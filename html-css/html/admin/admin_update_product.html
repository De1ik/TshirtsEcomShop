<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IgestShop - Update Product</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts: Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="../../css/admin_update_product.css" rel="stylesheet">
    <!-- Layout CSS -->
    <link href="../../css/layout.css" rel="stylesheet">
</head>
<body>
    <header>
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <a class="navbar-brand" href="../index.html">IgestShop</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="../product/page_list.html">Shop</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="../product/page_list.html">On Sale</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="../product/page_list.html">New Collections</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./admin_products_list.html">Admin Products List</a>
                        </li>
                    </ul>
                    <form class="d-flex">
                        <input class="form-control search-bar me-2" type="search" placeholder="Search products..." aria-label="Search">
                    </form>
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="../order/cart.html"><i class="bi bi-cart"></i></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="../auth/profile.html"><i class="bi bi-person"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="container my-5">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../index.html">Home</a></li>
                <li class="breadcrumb-item"><a href="./admin_products_list.html">Admin Panel Products</a></li>
                <li class="breadcrumb-item active" aria-current="page">Update Product</li>
            </ol>
        </nav>
        <section class="row col-12">
            <div class="update-product-form">
                <h2>Update Product</h2>
                <form id="updateProductForm">
                    <div class="row align-items-start">
                        <!-- First Column: Product Images with Scroller and Select Photo -->
                        <div class="col-md-3 mb-4">
                            <div class="form-group mb-4">
                                <label for="productPhoto" class="form-label">Select photo</label>
                                <input type="file" class="form-control" id="productPhoto" accept="image/*" multiple>
                            </div>
                            <div class="product-images" id="productImages">
                                <div class="image-wrapper">
                                    <img src="../../../images/tshirt-noback/tshirt-logo-1.png" alt="Product Image 1">
                                    <button type="button" class="delete-image-btn" onclick="deleteImage(this)">×</button>
                                </div>
                                <div class="image-wrapper">
                                    <img src="../../../images/tshirt-noback/tshirt-logo-2.png" alt="Product Image 2">
                                    <button type="button" class="delete-image-btn" onclick="deleteImage(this)">×</button>
                                </div>
                                <div class="image-wrapper">
                                    <img src="../../../images/tshirt-noback/brand-tshirt.png" alt="Product Image 3">
                                    <button type="button" class="delete-image-btn" onclick="deleteImage(this)">×</button>
                                </div>
                                <div class="image-wrapper">
                                    <img src="../../../images/tshirt-noback/1.png" alt="Product Image 4">
                                    <button type="button" class="delete-image-btn" onclick="deleteImage(this)">×</button>
                                </div>
                            </div>
                        </div>
                        <!-- Second Column: Product Information (Compact) -->
                        <section class="col-md-7 mb-4">
                            <div class="form-group mb-3">
                                <label for="productName" class="form-label">Name of Product</label>
                                <input type="text" class="form-control" id="productName" value="Top Hoodie" required>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="category" class="form-label">Category</label>
                                        <select class="form-select" id="category" required>
                                            <option value="hoodie" selected>Hoodie</option>
                                            <option value="t-shirt">T-Shirt</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="price" class="form-label">Price (€)</label>
                                        <input type="number" class="form-control" id="price" value="60" min="0" step="0.01" required>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="collection" class="form-label">Collection</label>
                                        <select class="form-select" id="collection" required>
                                            <option value="line1" selected>Line name 1</option>
                                            <option value="line2">Line name 2</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="amount" class="form-label">Amount</label>
                                        <input type="number" class="form-control" id="amount" value="27" min="0" required>
                                    </div>
                                </div>
                            </div>
                            <!-- Discount Section -->
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="enableDiscount" onchange="toggleDiscountFields()">
                                    <label class="form-check-label" for="enableDiscount">Enable Discount</label>
                                </div>
                            </div>
                            <div id="discountFields" style="display: none;">
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <div class="form-group">
                                            <label for="discountPrice" class="form-label">Discount Price (€)</label>
                                            <input type="number" class="form-control" id="discountPrice" min="0" step="0.01">
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="form-group">
                                            <label for="discountStartDate" class="form-label">Start Date</label>
                                            <input type="date" class="form-control" id="discountStartDate">
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="form-group">
                                            <label for="discountEndDate" class="form-label">End Date</label>
                                            <input type="date" class="form-control" id="discountEndDate">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Gender</label>
                                <div class="d-flex">
                                    <div class="form-check me-4">
                                        <input class="form-check-input" type="radio" name="sex" id="sex-men" value="men">
                                        <label class="form-check-label" for="sex-men">Men</label>
                                    </div>
                                    <div class="form-check me-4">
                                        <input class="form-check-input" type="radio" name="sex" id="sex-women" value="women">
                                        <label class="form-check-label" for="sex-women">Women</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="sex" id="sex-unisex" value="unisex" checked>
                                        <label class="form-check-label" for="sex-unisex">Unisex</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group mb-3">
                                <label for="description" class="form-label">Product Description</label>
                                <textarea class="form-control" id="description" rows="4" required>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</textarea>
                            </div>
                        </section>
                        <!-- Third Column: Update and Delete Buttons -->
                        <aside class="col-md-2 mb-4">
                            <div class="d-flex flex-column h-100">
                                <button type="submit" class="btn btn-update mb-2">Update Product</button>
                                <button type="button" class="btn btn-delete" data-bs-toggle="modal" data-bs-target="#deleteConfirmationModal">Delete Product</button>
                            </div>
                        </aside>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <!-- Delete Confirmation Modal (for deleting the entire product) -->
    <div class="modal fade" id="deleteConfirmationModal" tabindex="-1" aria-labelledby="deleteConfirmationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteConfirmationModalLabel">Delete Confirmation</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Are you sure want to delete product "Hoodie"?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-no" data-bs-dismiss="modal">No</button>
                    <a href="./admin_products_list.html"><button type="button" class="btn btn-confirm-delete">Delete Product <i class="bi bi-trash ms-1"></i></button></a>
                </div>
            </div>
        </div>
    </div>

    <!-- Banner -->
    <section  class="banner">
        ENJOY EVERY MOMENT!
    </section>

    <!-- Minimalistic Footer -->
    <footer class="footer">
        <div class="container">
            <div class="social-icons">
                <a href="#"><i class="bi bi-twitter"></i></a>
                <a href="#"><i class="bi bi-facebook"></i></a>
                <a href="#"><i class="bi bi-instagram"></i></a>
                <a href="#"><i class="bi bi-youtube"></i></a>
            </div>
            <p>IgestShop © 2000-2023, All Rights Reserved</p>
        </div>
    </footer>

    <!-- Bootstrap JS and Icons -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <!-- JavaScript for Image Upload, Deletion, and Discount Validation -->
    <script>
        // Handle image upload
        const productPhotoInput = document.getElementById('productPhoto');
        const productImagesContainer = document.getElementById('productImages');

        productPhotoInput.addEventListener('change', (event) => {
            const files = event.target.files;
            for (let file of files) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageWrapper = document.createElement('div');
                    imageWrapper.classList.add('image-wrapper');

                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.alt = 'Uploaded Product Image';

                    const deleteBtn = document.createElement('button');
                    deleteBtn.type = 'button';
                    deleteBtn.classList.add('delete-image-btn');
                    deleteBtn.innerHTML = '×';
                    deleteBtn.onclick = () => deleteImage(deleteBtn);

                    imageWrapper.appendChild(img);
                    imageWrapper.appendChild(deleteBtn);
                    productImagesContainer.appendChild(imageWrapper);
                };
                reader.readAsDataURL(file);
            }
        });

        // Delete image function
        function deleteImage(button) {
            const imageWrapper = button.parentElement;
            imageWrapper.remove();
        }

        // Toggle discount fields visibility
        function toggleDiscountFields() {
            const enableDiscount = document.getElementById('enableDiscount').checked;
            const discountFields = document.getElementById('discountFields');
            discountFields.style.display = enableDiscount ? 'block' : 'none';

            // If discount is disabled, clear the fields
            if (!enableDiscount) {
                document.getElementById('discountPrice').value = '';
                document.getElementById('discountStartDate').value = '';
                document.getElementById('discountEndDate').value = '';
            }
        }

        // Form submission with discount validation
        const updateProductForm = document.getElementById('updateProductForm');
        updateProductForm.addEventListener('submit', (event) => {
            event.preventDefault();

            const enableDiscount = document.getElementById('enableDiscount').checked;
            if (enableDiscount) {
                const price = parseFloat(document.getElementById('price').value);
                const discountPrice = parseFloat(document.getElementById('discountPrice').value);
                const startDate = document.getElementById('discountStartDate').value;
                const endDate = document.getElementById('discountEndDate').value;
                const currentDate = new Date('2025-03-28');

                // Validate discount price
                if (isNaN(discountPrice) || discountPrice <= 0) {
                    alert('Please enter a valid discount price.');
                    return;
                }
                if (discountPrice >= price) {
                    alert('Discount price must be less than the original price.');
                    return;
                }

                // Validate dates
                if (!startDate || !endDate) {
                    alert('Please provide both start and end dates for the discount.');
                    return;
                }

                const start = new Date(startDate);
                const end = new Date(endDate);

                if (start > end) {
                    alert('Start date cannot be after the end date.');
                    return;
                }

                if (start < currentDate) {
                    alert('Start date cannot be in the past.');
                    return;
                }
            }

            alert('Product updated successfully!');
            // updateProductForm.submit();
        });
    
    </script>
</body>
</html>